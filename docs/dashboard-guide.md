# Team-Shinchan ëŒ€ì‹œë³´ë“œ ì‚¬ìš© ê°€ì´ë“œ

> ë²„ì „: 1.1.0 | ìµœì¢… ìˆ˜ì •: 2026-02-22

---

## ëª©ì°¨

1. [ê°œìš”](#1-ê°œìš”)
2. [ì„¤ì¹˜ ë° ì„¤ì •](#2-ì„¤ì¹˜-ë°-ì„¤ì •)
3. [ì‚¬ìš©ë²•](#3-ì‚¬ìš©ë²•)
4. [ì•„í‚¤í…ì²˜](#4-ì•„í‚¤í…ì²˜)
5. [API ë ˆí¼ëŸ°ìŠ¤](#5-api-ë ˆí¼ëŸ°ìŠ¤)
6. [íŠ¸ëŸ¬ë¸”ìŠˆíŒ…](#6-íŠ¸ëŸ¬ë¸”ìŠˆíŒ…)
7. [ê°œë°œì ì°¸ê³ ](#7-ê°œë°œì-ì°¸ê³ )

---

## 1. ê°œìš”

### ëŒ€ì‹œë³´ë“œë€?

Team-Shinchan ëŒ€ì‹œë³´ë“œëŠ” Claude Code ì„¸ì…˜ì—ì„œ AI ì—ì´ì „íŠ¸ë“¤ì´ ì–´ë–»ê²Œ í˜‘ë ¥í•˜ëŠ”ì§€ë¥¼ **ì‹¤ì‹œê°„ìœ¼ë¡œ ì‹œê°í™”**í•˜ëŠ” ì›¹ ì¸í„°í˜ì´ìŠ¤ì…ë‹ˆë‹¤.

Claude Codeê°€ ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ë™ì•ˆ:
- ì–´ë–¤ ì—ì´ì „íŠ¸ê°€ í˜„ì¬ í™œë™ ì¤‘ì¸ì§€
- ì—ì´ì „íŠ¸ ê°„ ìœ„ì„(delegation) íë¦„ì´ ì–´ë–»ê²Œ ì§„í–‰ë˜ëŠ”ì§€
- ì›Œí¬í”Œë¡œìš°ê°€ 4ë‹¨ê³„ ì¤‘ ì–´ëŠ ë‹¨ê³„ì— ìˆëŠ”ì§€
- ì—ì´ì „íŠ¸ë“¤ì´ ì£¼ê³ ë°›ëŠ” ë©”ì‹œì§€
- Debate(í† ë¡ ) ì§„í–‰ ìƒí™©

ì´ ëª¨ë“  ê²ƒì„ ë¸Œë¼ìš°ì €ì—ì„œ ì‹¤ì‹œê°„ìœ¼ë¡œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ì£¼ìš” ê¸°ëŠ¥

| ê¸°ëŠ¥ | ì„¤ëª… |
|------|------|
| ì—ì´ì „íŠ¸ íŒ¨ë„ | 15ëª… ì—ì´ì „íŠ¸ì˜ ì‹¤ì‹œê°„ ìƒíƒœ (idle / working / delegating) |
| ì›Œí¬í”Œë¡œìš° í”„ë¡œê·¸ë ˆìŠ¤ ë°” | Requirements > Planning > Execution > Completion 4ë‹¨ê³„ ì§„í–‰ ìƒí™© |
| í™œë™ íƒ€ì„ë¼ì¸ | ì´ë²¤íŠ¸ë¥¼ ì‹œê°„ìˆœìœ¼ë¡œ í‘œì‹œí•˜ëŠ” ì‹¤ì‹œê°„ ë¡œê·¸ |
| ëŒ€í™” ë·° | ì—ì´ì „íŠ¸ ê°„ ë©”ì‹œì§€ë¥¼ ì±„íŒ… í˜•íƒœë¡œ í‘œì‹œ |
| ìœ„ì„ íë¦„ ì‹œê°í™” | ì—ì´ì „íŠ¸ ìœ„ì„ ì²´ì¸ (ì˜ˆ: Shinnosuke -> Nene -> Bo) |
| Debate íŒ¨ë„ | í† ë¡  ì§„í–‰ ì‹œ íŒ¨ë„ë¦¬ìŠ¤íŠ¸ë³„ ì˜ê²¬ê³¼ ê²°ë¡  ì‹¤ì‹œê°„ í‘œì‹œ |
| SSE ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ | í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ ì—†ì´ ìë™ ê°±ì‹  |

### ëŒ€ì‹œë³´ë“œ ë ˆì´ì•„ì›ƒ (ASCII ë‹¤ì´ì–´ê·¸ë¨)

```
+------------------------------------------------------------------+
|  Team-Shinchan Dashboard                    [ì—°ê²° ìƒíƒœ: ë…¹ìƒ‰ ì ] |
+------------------------------------------------------------------+
|                |                                                  |
| [ì—ì´ì „íŠ¸ íŒ¨ë„] |  [ì›Œí¬í”Œë¡œìš° í”„ë¡œê·¸ë ˆìŠ¤ ë°”]                       |
|                |  Requirements > Planning > Execution > Completion|
| ğŸ‘¦ Shinnosuke  |  ======================>                         |
|  Orchestrator  |                                                  |
|  [working]     |  [íƒ€ì„ë¼ì¸] [ëŒ€í™”] [í† ë¡ ]  <-- íƒ­ ì „í™˜           |
|                |  +-----------------------------------------+    |
| ğŸŒ¸ Himawari    |  | [íƒ€ì„ë¼ì¸ íƒ­ - ê¸°ë³¸]                    |    |
|  Atlas         |  |                                         |    |
|  [idle]        |  | 14:23:01  ğŸ‘¦ Shinnosuke ì‘ì—… ì‹œì‘        |    |
|                |  | 14:23:03  ğŸ‘¦ -> ğŸ“‹ Nene ìœ„ì„            |    |
| ğŸŒ» Midori      |  | 14:23:05  ğŸ“‹ Nene ì‘ì—… ì¤‘               |    |
|  Debate Mod.   |  | 14:23:10  ğŸ“‹ -> ğŸ˜ª Bo ìœ„ì„             |    |
|  [idle]        |  |                                         |    |
|                |  +-----------------------------------------+    |
| ğŸ˜ª Bo          |                                                  |
|  Task Executor |  [ìœ„ì„ íë¦„]                                     |
|  [working]     |  ğŸ‘¦ Shinnosuke -> ğŸ“‹ Nene -> ğŸ˜ª Bo               |
|   ...          |                                                  |
+------------------------------------------------------------------+
```

---

## 2. ì„¤ì¹˜ ë° ì„¤ì •

### ì‚¬ì „ ìš”êµ¬ì‚¬í•­

- **Node.js 18.0.0 ì´ìƒ** (ìˆœìˆ˜ ë‚´ì¥ ëª¨ë“ˆë§Œ ì‚¬ìš©, ì™¸ë¶€ íŒ¨í‚¤ì§€ ë¶ˆí•„ìš”)
- `curl` ëª…ë ¹ì–´ (Hook ì´ë²¤íŠ¸ ì „ì†¡ìš©)
- Claude Code (í”ŒëŸ¬ê·¸ì¸ í™œì„±í™” í™˜ê²½)

Node.js ë²„ì „ í™•ì¸:

```bash
node --version
# v18.0.0 ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤
```

### ìë™ ì‹œì‘ ë°©ì‹ (ê¶Œì¥)

ëŒ€ì‹œë³´ë“œëŠ” **MCP ì„œë²„ë¡œ ìë™ ì‹¤í–‰**ë©ë‹ˆë‹¤. Claude Code ì„¸ì…˜ì´ ì‹œì‘ë  ë•Œ `.mcp.json` ì„¤ì •ì— ë”°ë¼ ìë™ìœ¼ë¡œ ê¸°ë™í•©ë‹ˆë‹¤.

`.mcp.json` ì„¤ì • (í”ŒëŸ¬ê·¸ì¸ ë£¨íŠ¸ì— ìœ„ì¹˜):

```json
{
  "mcpServers": {
    "team-shinchan-dashboard": {
      "command": "node",
      "args": ["${CLAUDE_PLUGIN_ROOT}/dashboard/server.mjs"],
      "env": {
        "DASHBOARD_PORT": "3333",
        "SHINCHAN_DOCS_DIR": ".shinchan-docs"
      }
    }
  }
}
```

Claude Codeë¥¼ ì‹œì‘í•˜ë©´ ìë™ìœ¼ë¡œ `http://localhost:3333`ì—ì„œ ëŒ€ì‹œë³´ë“œì— ì ‘ì†í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ìˆ˜ë™ ì‹œì‘ ë°©ì‹ (í…ŒìŠ¤íŠ¸ìš©)

ê°œë°œì´ë‚˜ í…ŒìŠ¤íŠ¸ ëª©ì ìœ¼ë¡œ ëŒ€ì‹œë³´ë“œë¥¼ ì§ì ‘ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```bash
# ê¸°ë³¸ ì‹¤í–‰ (í¬íŠ¸ 3333)
node /path/to/team-shinchan/dashboard/server.mjs

# í¬íŠ¸ ë³€ê²½
DASHBOARD_PORT=3334 node dashboard/server.mjs

# ë¬¸ì„œ ë””ë ‰í† ë¦¬ ì§€ì • (ì ˆëŒ€ ê²½ë¡œ)
SHINCHAN_DOCS_DIR=/absolute/path/to/.shinchan-docs node dashboard/server.mjs

# ë¬¸ì„œ ë””ë ‰í† ë¦¬ ì§€ì • (ìƒëŒ€ ê²½ë¡œ - í”ŒëŸ¬ê·¸ì¸ ë£¨íŠ¸ ê¸°ì¤€)
SHINCHAN_DOCS_DIR=.shinchan-docs node dashboard/server.mjs
```

ì„œë²„ ë¡œê·¸ëŠ” `stderr`ë¡œ ì¶œë ¥ë©ë‹ˆë‹¤ (MCP stdioê°€ `stdout`ì„ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸):

```
[dashboard] íŒŒì¼ ê°ì‹œ ì‹œì‘: /path/to/.shinchan-docs
[dashboard] HTTP ì„œë²„ ì‹œì‘: http://localhost:3333
[dashboard] MCP stdio ì„œë²„ ì¤€ë¹„ ì™„ë£Œ
```

### í™˜ê²½ë³€ìˆ˜ ì„¤ì •

| í™˜ê²½ë³€ìˆ˜ | ê¸°ë³¸ê°’ | ì„¤ëª… |
|----------|--------|------|
| `DASHBOARD_PORT` | `3333` | HTTP ì„œë²„ í¬íŠ¸ ë²ˆí˜¸ |
| `SHINCHAN_DOCS_DIR` | `.shinchan-docs` | ì›Œí¬í”Œë¡œìš° ë¬¸ì„œ ë””ë ‰í† ë¦¬ ê²½ë¡œ (ì ˆëŒ€ ê²½ë¡œ ë˜ëŠ” í”ŒëŸ¬ê·¸ì¸ ë£¨íŠ¸ ê¸°ì¤€ ìƒëŒ€ ê²½ë¡œ) |
| `DASHBOARD_URL` | `http://localhost:3333` | Hook ì´ë²¤íŠ¸ ì „ì†¡ ëŒ€ìƒ URL (send-event.shì—ì„œ ì‚¬ìš©) |
| `DASHBOARD_STANDALONE` | ë¯¸ì§€ì› | (í–¥í›„ ì˜ˆì •) ë…ë¦½ ì‹¤í–‰ ëª¨ë“œ |
| `DASHBOARD_AUTO_OPEN` | `true` | ì„œë²„ ì‹œì‘ ì‹œ ë¸Œë¼ìš°ì € ìë™ ì—´ê¸° (`false`ë¡œ ë¹„í™œì„±í™”) |

> **ì°¸ê³ **: `SHINCHAN_DOCS_DIR`ì— ì ˆëŒ€ ê²½ë¡œë¥¼ ì§€ì •í•˜ë©´ ê·¸ ê²½ë¡œë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ê³ , ìƒëŒ€ ê²½ë¡œë¥¼ ì§€ì •í•˜ë©´ í”ŒëŸ¬ê·¸ì¸ ë£¨íŠ¸(`${CLAUDE_PLUGIN_ROOT}`)ë¥¼ ê¸°ì¤€ìœ¼ë¡œ í•´ì„í•©ë‹ˆë‹¤.

---

## 3. ì‚¬ìš©ë²•

### ëŒ€ì‹œë³´ë“œ ì ‘ì†

Claude Code ì„¸ì…˜ì´ ì‹œì‘ëœ í›„ ë¸Œë¼ìš°ì €ì—ì„œ ì ‘ì†í•©ë‹ˆë‹¤:

```
http://localhost:3333
```

í¬íŠ¸ë¥¼ ë³€ê²½í•œ ê²½ìš°:

```
http://localhost:{DASHBOARD_PORT}
```

### ëŒ€ì‹œë³´ë“œ ë ˆì´ì•„ì›ƒ ì„¤ëª…

#### í—¤ë” ì˜ì—­

- **ì œëª©**: "Team-Shinchan Dashboard"
- **ì—°ê²° ìƒíƒœ í‘œì‹œê¸°**: SSE ì—°ê²° ìƒíƒœë¥¼ ìƒ‰ìƒìœ¼ë¡œ í‘œì‹œ
  - ë…¹ìƒ‰ ì : ì„œë²„ì™€ ì‹¤ì‹œê°„ ì—°ê²° ì¤‘
  - ë¹¨ê°„ ì : ì—°ê²° ëŠê¹€ (ìë™ ì¬ì—°ê²° ì‹œë„)

#### ì™¼ìª½ ì‚¬ì´ë“œë°” - ì—ì´ì „íŠ¸ íŒ¨ë„

15ëª…ì˜ ì—ì´ì „íŠ¸ê°€ ë ˆì´ì–´ë³„ë¡œ í‘œì‹œë©ë‹ˆë‹¤:

```
Orchestration:  ğŸ‘¦ Shinnosuke  ğŸŒ¸ Himawari  ğŸŒ» Midori
Execution:      ğŸ˜ª Bo          ğŸ© Kazama
Specialist:     ğŸ€ Aichan      ğŸœ Bunta     ğŸ™ Masao
Advisory:       ğŸ‘” Hiroshi     ğŸ“‹ Nene      ğŸ‘© Misae  ğŸ¦¸ Action Kamen
Utility:        ğŸ¶ Shiro       ğŸ“š Masumi    ğŸ–¼ï¸ Ume
```

ê° ì—ì´ì „íŠ¸ ì¹´ë“œì—ëŠ” ë‹¤ìŒ ì •ë³´ê°€ í‘œì‹œë©ë‹ˆë‹¤:
- **ì´ëª¨ì§€ + ì´ë¦„**: ì—ì´ì „íŠ¸ ì‹ë³„
- **ì—­í• **: Orchestrator, Planner, Code Executor ë“±
- **ìƒíƒœ ë°°ì§€**:
  - `idle`: ëŒ€ê¸° ì¤‘ (íšŒìƒ‰)
  - `working`: ì‘ì—… ì¤‘ (ë…¹ìƒ‰ í„ìŠ¤ ì• ë‹ˆë©”ì´ì…˜)
  - `delegating`: ìœ„ì„ ì¤‘ (ì£¼í™©ìƒ‰)
  - `receiving`: ìœ„ì„ ë°›ëŠ” ì¤‘ (íŒŒë€ìƒ‰)

ì—ì´ì „íŠ¸ ì¹´ë“œë¥¼ í´ë¦­í•˜ë©´ ìƒì„¸ ì •ë³´(ë§ˆì§€ë§‰ ë©”ì‹œì§€, ì‘ì—… ì‹œê°„ ë“±)ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

#### ì¤‘ì•™ ìƒë‹¨ - ì›Œí¬í”Œë¡œìš° í”„ë¡œê·¸ë ˆìŠ¤ ë°”

Team-Shinchanì˜ 4ë‹¨ê³„ ì›Œí¬í”Œë¡œìš° ì§„í–‰ ìƒí™©ì„ í‘œì‹œí•©ë‹ˆë‹¤:

```
[1. Requirements] > [2. Planning] > [3. Execution] > [4. Completion]
       ì™„ë£Œ              ì™„ë£Œ          ì§„í–‰ ì¤‘            ëŒ€ê¸°
```

PROGRESS.md íŒŒì¼ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ê°ì‹œí•˜ì—¬ ìë™ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤.

#### ì¤‘ì•™ í•˜ë‹¨ - íƒ­ ì „í™˜ ì˜ì—­

ì„¸ ê°€ì§€ íƒ­ìœ¼ë¡œ ë‹¤ì–‘í•œ ë·°ë¥¼ ì œê³µí•©ë‹ˆë‹¤:

**[íƒ€ì„ë¼ì¸] íƒ­ (ê¸°ë³¸)**

ì´ë²¤íŠ¸ë¥¼ ì‹œê°„ìˆœìœ¼ë¡œ í‘œì‹œí•©ë‹ˆë‹¤. ê° í•­ëª©ì—ëŠ” ë‹¤ìŒì´ í¬í•¨ë©ë‹ˆë‹¤:
- íƒ€ì„ìŠ¤íƒ¬í”„
- ì´ë²¤íŠ¸ ì•„ì´ì½˜: `SubagentStart(ë…¹ìƒ‰)`, `SubagentStop(ë¹¨ê°„)`, `PostToolUse(ë Œì¹˜)`, `UserPrompt(ë§í’ì„ )`, `Stop(ì •ì§€)`
- ì—ì´ì „íŠ¸ ì´ëª¨ì§€ + ì´ë¦„
- ì´ë²¤íŠ¸ ìš”ì•½ ë©”ì‹œì§€

**[ëŒ€í™”] íƒ­**

ì—ì´ì „íŠ¸ ê°„ ë©”ì‹œì§€ë¥¼ ì±„íŒ… ë²„ë¸” í˜•íƒœë¡œ í‘œì‹œí•©ë‹ˆë‹¤:
- ì—ì´ì „íŠ¸ë³„ ìƒ‰ìƒ êµ¬ë¶„
- ìœ„ì„ ë©”ì‹œì§€ëŠ” í™”ì‚´í‘œ(â†’)ë¡œ ê°•ì¡° í‘œì‹œ: `ğŸ‘¦ [Shinnosuke] â†’ ğŸ˜ª [Bo] "íƒœìŠ¤í¬ ì„¤ëª…"`
- ì‚¬ìš©ì ì…ë ¥ë„ ë³„ë„ ìŠ¤íƒ€ì¼ë¡œ í‘œì‹œ
- ìµœì‹  ë©”ì‹œì§€ë¡œ ìë™ ìŠ¤í¬ë¡¤

**[í† ë¡ ] íƒ­**

Midoriê°€ Debateë¥¼ ì§„í–‰í•  ë•Œ ìë™ìœ¼ë¡œ í™œì„±í™”ë©ë‹ˆë‹¤:
- í† ë¡  ì£¼ì œ í‘œì‹œ
- íŒ¨ë„ë¦¬ìŠ¤íŠ¸ ì¹´ë“œ (ê° ì—ì´ì „íŠ¸ì˜ ì˜ê²¬ì„ ë¼ìš´ë“œë³„ë¡œ í‘œì‹œ)
- Debateê°€ ì—†ì„ ë•Œ: "ì§„í–‰ ì¤‘ì¸ í† ë¡ ì´ ì—†ìŠµë‹ˆë‹¤"
- Debate ì™„ë£Œ ì‹œ: ìµœì¢… ê²°ë¡  ê°•ì¡° í‘œì‹œ

#### í•˜ë‹¨ - ìœ„ì„ íë¦„

í˜„ì¬ í™œì„± ìœ„ì„ ì²´ì¸ì„ í™”ì‚´í‘œë¡œ ì‹œê°í™”í•©ë‹ˆë‹¤:

```
ğŸ‘¦ Shinnosuke -> ğŸ“‹ Nene -> ğŸ˜ª Bo
```

---

## 4. ì•„í‚¤í…ì²˜

### ì‹œìŠ¤í…œ ê°œìš”

ëŒ€ì‹œë³´ë“œëŠ” **ì™¸ë¶€ ì˜ì¡´ì„±ì´ ì „í˜€ ì—†ëŠ” ìˆœìˆ˜ Node.js** ì„œë²„ì…ë‹ˆë‹¤. ë‹¨ì¼ í”„ë¡œì„¸ìŠ¤ì—ì„œ ë‘ ê°€ì§€ í”„ë¡œí† ì½œì„ ë™ì‹œì— ì²˜ë¦¬í•©ë‹ˆë‹¤:

1. **MCP stdio ì„œë²„** (í‘œì¤€ ì…ì¶œë ¥): Claude Codeì™€ JSON-RPC 2.0ìœ¼ë¡œ í†µì‹ 
2. **HTTP ì„œë²„** (í¬íŠ¸ 3333): ë¸Œë¼ìš°ì € ë° Hook ì´ë²¤íŠ¸ ìˆ˜ì‹ 

### ë°ì´í„° íë¦„ ë‹¤ì´ì–´ê·¸ë¨ (ASCII)

```
+------------------------------------------------------------------+
|                    Claude Code Session                           |
|                                                                  |
|  +-------------+   +------------------------------------------+ |
|  | Prompt Hooks|   | Command Hooks (hooks/hooks.json)          | |
|  | (.md íŒŒì¼)  |   |                                          | |
|  |             |   | SubagentStart   -> send-event.sh         | |
|  | shinnosuke  |   | SubagentStop    -> send-event.sh         | |
|  | workflow-   |   | PostToolUse     -> send-event.sh         | |
|  | guard       |   | UserPromptSubmit-> send-event.sh         | |
|  | auto-verify |   | Stop            -> send-event.sh         | |
|  | load-kb     |   | SessionStart    -> send-event.sh         | |
|  | auto-retro  |   | SessionEnd      -> send-event.sh         | |
|  +-------------+   +------------------+-----------------------+ |
|                                       | HTTP POST /api/events   |
+---------------------------------------+-------------------------+
                                        |
                                        v
+------------------------------------------------------------------+
|              dashboard/server.mjs (Node.js)                      |
|                                                                  |
|  +-------------+  +--------------+  +------------------------+  |
|  | MCP stdio   |  | HTTP :3333   |  | fs.watch()             |  |
|  | (JSON-RPC)  |  |              |  | .shinchan-docs/ ê°ì‹œ   |  |
|  |             |  | POST /api/   |  |                        |  |
|  | tools:      |  |   events     |  | WORKFLOW_STATE.yaml    |  |
|  |  get_url    |  | GET  /api/   |  | PROGRESS.md            |  |
|  |  get_status |  |   *          |  | REQUESTS.md            |  |
|  |  send_event |  | GET  /       |  |   500ms ë””ë°”ìš´ìŠ¤       |  |
|  +-------------+  +-------+------+  +-----------+------------+  |
|                           |                     |                |
|                    +------+---------------------+------+         |
|                    |    In-Memory State (ì¸ë©”ëª¨ë¦¬)     |         |
|                    |                                   |         |
|                    | - workflow: {stage,phase,status}  |         |
|                    | - agents[15]: {status,lastSeen}   |         |
|                    | - events[1000]: ìµœê·¼ ì´ë²¤íŠ¸       |         |
|                    | - delegations[100]: ìœ„ì„ íë¦„     |         |
|                    | - messages[200]: ì—ì´ì „íŠ¸ ë©”ì‹œì§€  |         |
|                    | - debate: {topic,panelists,...}   |         |
|                    | - session: {active,startedAt}     |         |
|                    +------+----------------------------+         |
|                           | SSE broadcast                        |
+---------------------------+--------------------------------------+
                            |
                            v
+------------------------------------------------------------------+
|              ë¸Œë¼ìš°ì € (http://localhost:3333)                     |
|              dashboard/public/index.html                         |
|                                                                  |
|  EventSource('/api/events/stream')                               |
|  fetch('/api/status')  fetch('/api/agents')                      |
|                                                                  |
|  SSE ì´ë²¤íŠ¸ ìˆ˜ì‹  -> DOM ì—…ë°ì´íŠ¸ -> ì‹¤ì‹œê°„ ë°˜ì˜                  |
+------------------------------------------------------------------+
```

### í•µì‹¬ ì„¤ê³„ ê²°ì •

| í•­ëª© | ì„ íƒ | ì´ìœ  |
|------|------|------|
| ëŸ°íƒ€ì„ | Node.js ìˆœìˆ˜ ë‚´ì¥ ëª¨ë“ˆ | ì™¸ë¶€ íŒ¨í‚¤ì§€ ì„¤ì¹˜ ë¶ˆí•„ìš”, Claude Code ì‚¬ìš©ìëŠ” Node.js ë³´ìœ  |
| ì‹¤ì‹œê°„ í†µì‹  | SSE (Server-Sent Events) | WebSocketë³´ë‹¤ êµ¬í˜„ ë‹¨ìˆœ, ì„œë²„->í´ë¼ì´ì–¸íŠ¸ ë‹¨ë°©í–¥ìœ¼ë¡œ ì¶©ë¶„ |
| ë°ì´í„° ì €ì¥ | In-Memory Array | SQLite ë¶ˆí•„ìš”, ì„¸ì…˜ ì¤‘ì—ë§Œ ìœ íš¨í•œ ë°ì´í„° |
| í”„ë¡ íŠ¸ì—”ë“œ | ë‹¨ì¼ HTML (ì¸ë¼ì¸ JS/CSS) | ë¹Œë“œ ë„êµ¬ ë¶ˆí•„ìš”, ë°”ë‹ë¼ JS |
| Hook ì „ì†¡ | curl + HTTP POST | ë²”ìš©ì , ëª¨ë“  OSì—ì„œ ì‚¬ìš© ê°€ëŠ¥ |
| ë¡œê¹… | `process.stderr` ì „ìš© | MCP stdioê°€ `stdout`ì„ ì‚¬ìš©í•˜ë¯€ë¡œ `console.log` ê¸ˆì§€ |

### íŒŒì¼ êµ¬ì¡°

```
team-shinchan/
â”œâ”€â”€ .mcp.json                     # MCP ì„œë²„ ë“±ë¡ (Claude Codeê°€ ìë™ìœ¼ë¡œ ì½ìŒ)
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ hooks.json                # Command Hook ì •ì˜ (7ê°€ì§€ ì´ë²¤íŠ¸)
â”‚   â””â”€â”€ send-event.sh             # Hook ì´ë²¤íŠ¸ -> HTTP POST ë³€í™˜ ìŠ¤í¬ë¦½íŠ¸
â””â”€â”€ dashboard/
    â”œâ”€â”€ server.mjs                # MCP stdio + HTTP ì„œë²„ (ë‹¨ì¼ íŒŒì¼)
    â”œâ”€â”€ package.json              # ë©”íƒ€ë°ì´í„°ë§Œ (ì˜ì¡´ì„± ì—†ìŒ)
    â””â”€â”€ public/
        â””â”€â”€ index.html            # ë‹¨ì¼ HTML ëŒ€ì‹œë³´ë“œ (ì¸ë¼ì¸ CSS/JS)
```

---

## 5. API ë ˆí¼ëŸ°ìŠ¤

ëª¨ë“  APIëŠ” `http://localhost:3333` (ë˜ëŠ” ì„¤ì •ëœ í¬íŠ¸)ë¥¼ ê¸°ì¤€ìœ¼ë¡œ í•©ë‹ˆë‹¤. CORSëŠ” ëª¨ë“  ì¶œì²˜(`*`)ì— í—ˆìš©ë©ë‹ˆë‹¤.

---

### GET /api/status

ì„œë²„ ë° ì›Œí¬í”Œë¡œìš° ì „ì²´ ìƒíƒœë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.

**ì‘ë‹µ ì˜ˆì‹œ:**

```json
{
  "workflow": {
    "stage": "execution",
    "phase": "Phase 2",
    "status": "active",
    "docId": "haze-001"
  },
  "session": {
    "active": true,
    "startedAt": "2026-02-19T14:00:00.000Z"
  },
  "delegationChain": ["shinnosuke", "nene", "bo"],
  "eventCount": 42,
  "delegationCount": 7,
  "messageCount": 15,
  "sseClients": 1,
  "server": {
    "port": 3333,
    "uptime": 3600.5,
    "version": "1.0.0",
    "startedAt": "2026-02-19T13:00:00.000Z"
  },
  "timestamp": "2026-02-19T14:23:00.000Z"
}
```

---

### GET /api/agents

15ëª… ì—ì´ì „íŠ¸ì˜ ì •ì  ì •ë³´ ë° ë™ì  ìƒíƒœë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.

**ì‘ë‹µ ì˜ˆì‹œ:**

```json
{
  "agents": [
    {
      "id": "shinnosuke",
      "emoji": "ğŸ‘¦",
      "name": "Shinnosuke",
      "role": "Orchestrator",
      "layer": "Orchestration",
      "model": "opus",
      "status": {
        "active": true,
        "status": "working",
        "lastSeen": "2026-02-19T14:23:00.000Z",
        "lastMessage": "ì‘ì—…ì„ ì‹œì‘í•©ë‹ˆë‹¤..."
      }
    }
  ]
}
```

---

### GET /api/events

ìµœê·¼ ì´ë²¤íŠ¸ ëª©ë¡ì„ ë°˜í™˜í•©ë‹ˆë‹¤.

**ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°:**

| íŒŒë¼ë¯¸í„° | ê¸°ë³¸ê°’ | ì„¤ëª… |
|----------|--------|------|
| `limit` | `50` | ë°˜í™˜í•  ìµœëŒ€ ì´ë²¤íŠ¸ ìˆ˜ (ìµœëŒ€ 1000) |

**ì‘ë‹µ ì˜ˆì‹œ:**

```json
{
  "events": [
    {
      "id": 1708358580000,
      "type": "agent_start",
      "agent": "bo",
      "timestamp": "2026-02-19T14:23:00.000Z"
    }
  ],
  "total": 42
}
```

---

### GET /api/delegations

ìœ„ì„ íë¦„ ê¸°ë¡ê³¼ í˜„ì¬ ìœ„ì„ ì²´ì¸ì„ ë°˜í™˜í•©ë‹ˆë‹¤.

**ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°:**

| íŒŒë¼ë¯¸í„° | ê¸°ë³¸ê°’ | ì„¤ëª… |
|----------|--------|------|
| `limit` | `50` | ë°˜í™˜í•  ìµœëŒ€ ìœ„ì„ ìˆ˜ (ìµœëŒ€ 100) |

**ì‘ë‹µ ì˜ˆì‹œ:**

```json
{
  "delegations": [
    {
      "from": "shinnosuke",
      "to": "nene",
      "task": "ìš”êµ¬ì‚¬í•­ ë¶„ì„ ì‹œì‘",
      "timestamp": "2026-02-19T14:23:00.000Z"
    }
  ],
  "chain": ["shinnosuke", "nene", "bo"],
  "total": 7
}
```

---

### GET /api/messages

ì—ì´ì „íŠ¸ ë©”ì‹œì§€ íˆìŠ¤í† ë¦¬ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.

**ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°:**

| íŒŒë¼ë¯¸í„° | ê¸°ë³¸ê°’ | ì„¤ëª… |
|----------|--------|------|
| `limit` | `50` | ë°˜í™˜í•  ìµœëŒ€ ë©”ì‹œì§€ ìˆ˜ (ìµœëŒ€ 200) |
| `agent` | (ì—†ìŒ) | íŠ¹ì • ì—ì´ì „íŠ¸ì˜ ë©”ì‹œì§€ë§Œ í•„í„°ë§ |
| `type` | (ì—†ìŒ) | `chat` ì§€ì • ì‹œ íŒŒì‹±ëœ ì—ì´ì „íŠ¸ ë©”ì‹œì§€ë§Œ ë°˜í™˜ |

**ì‘ë‹µ ì˜ˆì‹œ:**

```json
{
  "messages": [
    {
      "agent": "bo",
      "content": "ğŸ˜ª [Bo] êµ¬í˜„ì„ ì‹œì‘í•˜ê² ìŠµë‹ˆë‹¤.",
      "parsed": {
        "type": "agent_message",
        "agent": "bo",
        "content": "êµ¬í˜„ì„ ì‹œì‘í•˜ê² ìŠµë‹ˆë‹¤."
      },
      "timestamp": "2026-02-19T14:23:05.000Z"
    }
  ],
  "total": 15
}
```

---

### GET /api/debate

í˜„ì¬ Debate(í† ë¡ ) ìƒíƒœë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.

**ì‘ë‹µ ì˜ˆì‹œ:**

```json
{
  "debate": {
    "active": true,
    "topic": "REST vs GraphQL ì„ íƒ",
    "panelists": ["hiroshi", "bunta", "aichan"],
    "opinions": [
      {
        "agent": "hiroshi",
        "opinion": "RESTê°€ ë” ë‹¨ìˆœí•˜ê³  ìºì‹±ì´ ìš©ì´í•©ë‹ˆë‹¤.",
        "round": 1,
        "timestamp": "2026-02-19T14:23:10.000Z"
      }
    ],
    "conclusion": null,
    "startedAt": "2026-02-19T14:23:00.000Z",
    "endedAt": null
  },
  "timestamp": "2026-02-19T14:23:15.000Z"
}
```

---

### POST /api/events

Hook ìŠ¤í¬ë¦½íŠ¸ ë˜ëŠ” ì™¸ë¶€ ë„êµ¬ì—ì„œ ì´ë²¤íŠ¸ë¥¼ ì „ì†¡í•©ë‹ˆë‹¤.

**ìš”ì²­ í—¤ë”:**

```
Content-Type: application/json
```

**ìš”ì²­ ë³¸ë¬¸:**

`type` í•„ë“œëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤. ë‚˜ë¨¸ì§€ëŠ” ì´ë²¤íŠ¸ íƒ€ì…ì— ë”°ë¼ ë‹¤ë¦…ë‹ˆë‹¤ (ì•„ë˜ ì´ë²¤íŠ¸ íƒ€ì… ì°¸ì¡°).

```json
{
  "type": "agent_start",
  "agent": "bo"
}
```

**ì‘ë‹µ ì˜ˆì‹œ:**

```json
{
  "ok": true,
  "id": 1708358580123
}
```

**ì˜¤ë¥˜ ì‘ë‹µ:**

```json
{
  "error": "type í•„ë“œê°€ í•„ìš”í•©ë‹ˆë‹¤"
}
```

---

### GET /api/events/stream

SSE(Server-Sent Events) ìŠ¤íŠ¸ë¦¼ì…ë‹ˆë‹¤. ë¸Œë¼ìš°ì €ì˜ `EventSource` APIë¡œ ì—°ê²°í•©ë‹ˆë‹¤.

**ì—°ê²° ë°©ë²•:**

```javascript
const source = new EventSource('http://localhost:3333/api/events/stream');
```

**ì‘ë‹µ í—¤ë”:**

```
Content-Type: text/event-stream
Cache-Control: no-cache
Connection: keep-alive
```

**ì´ˆê¸° ì—°ê²° ì‹œ ì´ë²¤íŠ¸:**

```
event: connected
data: {"message":"SSE ì—°ê²° ì„±ê³µ","clientId":...,"timestamp":"...","workflow":{...}}
```

**Heartbeat (30ì´ˆë§ˆë‹¤):**

```
: heartbeat 2026-02-19T14:23:00.000Z
```

ì—°ê²°ì´ ëŠì–´ì§€ë©´ ë¸Œë¼ìš°ì €ê°€ ìë™ìœ¼ë¡œ ì¬ì—°ê²°ì„ ì‹œë„í•©ë‹ˆë‹¤.

---

## 6. íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### í¬íŠ¸ ì¶©ëŒ

**ì¦ìƒ:** ì„œë²„ ì‹œì‘ ì‹œ `EADDRINUSE: address already in use :::3333` ì˜¤ë¥˜ê°€ ë°œìƒí•©ë‹ˆë‹¤.

**í•´ê²° ë°©ë²•:**

1. ì‚¬ìš© ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ í™•ì¸ ë° ì¢…ë£Œ:

```bash
# í¬íŠ¸ 3333 ì‚¬ìš© í”„ë¡œì„¸ìŠ¤ í™•ì¸
lsof -i :3333

# ë˜ëŠ”
netstat -tlnp | grep 3333

# í•´ë‹¹ í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ
kill -9 <PID>
```

2. ë‹¤ë¥¸ í¬íŠ¸ ì‚¬ìš©:

```bash
# .mcp.jsonì—ì„œ í¬íŠ¸ ë³€ê²½
DASHBOARD_PORT=3334 node dashboard/server.mjs
```

3. `DASHBOARD_PORT` í™˜ê²½ë³€ìˆ˜ë¥¼ ë³€ê²½í•œ ê²½ìš°, `DASHBOARD_URL`ë„ í•¨ê»˜ ë³€ê²½í•´ì•¼ Hook ì´ë²¤íŠ¸ê°€ ì˜¬ë°”ë¥¸ í¬íŠ¸ë¡œ ì „ì†¡ë©ë‹ˆë‹¤:

```bash
DASHBOARD_URL=http://localhost:3334 DASHBOARD_PORT=3334 node dashboard/server.mjs
```

---

### ëŒ€ì‹œë³´ë“œê°€ ëœ¨ì§€ ì•Šì„ ë•Œ

**ì¦ìƒ:** `http://localhost:3333`ì— ì ‘ì†í•´ë„ í˜ì´ì§€ê°€ ë¡œë“œë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

**í™•ì¸ ì‚¬í•­:**

1. ì„œë²„ê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸:

```bash
ps aux | grep "server.mjs"
```

2. MCP ì„œë²„ê°€ ì •ìƒ ë“±ë¡ëëŠ”ì§€ í™•ì¸:
   - Claude Codeì—ì„œ `/mcp` ëª…ë ¹ìœ¼ë¡œ MCP ì„œë²„ ëª©ë¡ í™•ì¸
   - `team-shinchan-dashboard`ê°€ ëª©ë¡ì— ìˆì–´ì•¼ í•©ë‹ˆë‹¤

3. `dashboard/public/index.html` íŒŒì¼ ì¡´ì¬ ì—¬ë¶€ í™•ì¸:

```bash
ls dashboard/public/index.html
```

4. Node.js ë²„ì „ í™•ì¸:

```bash
node --version
# v18.0.0 ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤
```

5. stderr ë¡œê·¸ í™•ì¸:
   - MCP ì„œë²„ë¥¼ ìˆ˜ë™ìœ¼ë¡œ ì‹¤í–‰í•˜ë©´ stderrì—ì„œ ì˜¤ë¥˜ í™•ì¸ ê°€ëŠ¥:

```bash
node dashboard/server.mjs 2>&1 | grep '\[dashboard\]'
```

---

### ì´ë²¤íŠ¸ê°€ í‘œì‹œë˜ì§€ ì•Šì„ ë•Œ

**ì¦ìƒ:** ëŒ€ì‹œë³´ë“œëŠ” ì—´ë ¸ì§€ë§Œ ì—ì´ì „íŠ¸ ìƒíƒœê°€ ë³€í•˜ì§€ ì•Šê³  íƒ€ì„ë¼ì¸ì´ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.

**í™•ì¸ ì‚¬í•­:**

1. SSE ì—°ê²° ìƒíƒœ í™•ì¸:
   - í—¤ë”ì˜ ì—°ê²° ìƒíƒœ í‘œì‹œê¸°ê°€ ë…¹ìƒ‰ì¸ì§€ í™•ì¸
   - ë¹¨ê°„ìƒ‰ì´ë©´ SSE ì—°ê²°ì´ ëŠì–´ì§„ ê²ƒ (ìë™ ì¬ì—°ê²° ëŒ€ê¸° ì¤‘)

2. Hookì´ í™œì„±í™”ëëŠ”ì§€ í™•ì¸:
   - `hooks/hooks.json`ì´ Claude Codeì— ì˜¬ë°”ë¥´ê²Œ ë¡œë“œëëŠ”ì§€ í™•ì¸
   - Claude Codeì˜ Settings > Hooksì—ì„œ í™œì„± Hook ëª©ë¡ í™•ì¸

3. `send-event.sh` ê¶Œí•œ í™•ì¸:

```bash
ls -la hooks/send-event.sh
# -rwxr-xr-x ì´ì–´ì•¼ í•©ë‹ˆë‹¤ (ì‹¤í–‰ ê¶Œí•œ í•„ìš”)

# ê¶Œí•œ ë¶€ì—¬
chmod +x hooks/send-event.sh
```

4. curl ì§ì ‘ í…ŒìŠ¤íŠ¸:

```bash
# ì´ë²¤íŠ¸ ìˆ˜ë™ ì „ì†¡ í…ŒìŠ¤íŠ¸
curl -X POST http://localhost:3333/api/events \
  -H "Content-Type: application/json" \
  -d '{"type":"agent_start","agent":"bo"}'

# ì‘ë‹µ: {"ok":true,"id":...}
```

5. Hook ìŠ¤í¬ë¦½íŠ¸ ì§ì ‘ ì‹¤í–‰ í…ŒìŠ¤íŠ¸:

```bash
echo '{"agent_type":"team-shinchan:bo"}' | \
  HOOK_EVENT=SubagentStart \
  bash hooks/send-event.sh
```

---

### ì›Œí¬í”Œë¡œìš° ìƒíƒœê°€ ì—…ë°ì´íŠ¸ë˜ì§€ ì•Šì„ ë•Œ

**ì¦ìƒ:** ëŒ€ì‹œë³´ë“œì˜ ì›Œí¬í”Œë¡œìš° í”„ë¡œê·¸ë ˆìŠ¤ ë°”ê°€ ë³€í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

**í™•ì¸ ì‚¬í•­:**

1. `.shinchan-docs/` ë””ë ‰í† ë¦¬ ê²½ë¡œ í™•ì¸:
   - `SHINCHAN_DOCS_DIR`ê°€ ì˜¬ë°”ë¥¸ ê²½ë¡œë¥¼ ê°€ë¦¬í‚¤ëŠ”ì§€ í™•ì¸
   - ì ˆëŒ€ ê²½ë¡œ ë˜ëŠ” í”ŒëŸ¬ê·¸ì¸ ë£¨íŠ¸ ê¸°ì¤€ ìƒëŒ€ ê²½ë¡œ ë‘˜ ë‹¤ ì§€ì›

```bash
# ì„œë²„ ì‹œì‘ ì‹œ ë¡œê·¸ì—ì„œ ê²½ë¡œ í™•ì¸
[dashboard] íŒŒì¼ ê°ì‹œ ì‹œì‘: /path/to/.shinchan-docs
```

2. `WORKFLOW_STATE.yaml` íŒŒì¼ ì¡´ì¬ ì—¬ë¶€ í™•ì¸:

```bash
ls .shinchan-docs/*/WORKFLOW_STATE.yaml
```

3. YAML íŒŒì¼ í˜•ì‹ í™•ì¸:
   - ì„œë²„ëŠ” ì •ê·œì‹ìœ¼ë¡œ `stage:`, `phase:`, `status:`, `doc_id:` í•„ë“œë¥¼ ì¶”ì¶œí•©ë‹ˆë‹¤
   - `key: value` ë˜ëŠ” `key: "value"` í˜•ì‹ ëª¨ë‘ ì§€ì›

---

### ì¢€ë¹„ í”„ë¡œì„¸ìŠ¤ê°€ ë‚¨ì•„ìˆì„ ë•Œ

**ì¦ìƒ:** Claude Code ì„¸ì…˜ ì¬ì‹œì‘ í›„ì—ë„ ì´ì „ ëŒ€ì‹œë³´ë“œ ì„œë²„ í”„ë¡œì„¸ìŠ¤ê°€ í¬íŠ¸ë¥¼ ì ìœ í•˜ê³  ìˆìŠµë‹ˆë‹¤.

**í•´ê²° ë°©ë²•:**

ì„œë²„ëŠ” ì‹œì‘ ì‹œ ìë™ìœ¼ë¡œ ë‹¤ë¥¸ `server.mjs` í”„ë¡œì„¸ìŠ¤ë¥¼ ê°ì§€í•˜ê³  ì¢…ë£Œí•©ë‹ˆë‹¤ (`killZombieProcesses()`). ìë™ ì •ë¦¬ê°€ ì‹¤íŒ¨í•œ ê²½ìš° ìˆ˜ë™ìœ¼ë¡œ ì²˜ë¦¬í•©ë‹ˆë‹¤:

```bash
# ì‹¤í–‰ ì¤‘ì¸ server.mjs í”„ë¡œì„¸ìŠ¤ í™•ì¸
pgrep -f "node.*server\.mjs"

# í•´ë‹¹ PID ì¢…ë£Œ (PIDë¥¼ ì‹¤ì œ ê°’ìœ¼ë¡œ êµì²´)
kill -TERM <PID>

# ë˜ëŠ” ì¼ê´„ ì¢…ë£Œ
pkill -f "node.*server\.mjs"
```

---

### ë¸Œë¼ìš°ì €ê°€ ìë™ìœ¼ë¡œ ì—´ë¦¬ì§€ ì•Šì„ ë•Œ

**ì¦ìƒ:** ì„œë²„ ë¡œê·¸ì— `ë¸Œë¼ìš°ì € ì—´ê¸° ì‹¤íŒ¨` ë©”ì‹œì§€ê°€ í‘œì‹œë˜ê±°ë‚˜, ë¸Œë¼ìš°ì €ê°€ ì—´ë¦¬ì§€ ì•ŠìŠµë‹ˆë‹¤.

**í™•ì¸ ì‚¬í•­:**

1. `DASHBOARD_AUTO_OPEN` í™˜ê²½ë³€ìˆ˜ í™•ì¸:

```bash
# ë¹„í™œì„±í™” ì—¬ë¶€ í™•ì¸
echo $DASHBOARD_AUTO_OPEN
# falseë©´ ë¸Œë¼ìš°ì €ê°€ ì—´ë¦¬ì§€ ì•Šë„ë¡ ì„¤ì •ëœ ê²ƒ

# í™œì„±í™” (ê¸°ë³¸ê°’)
DASHBOARD_AUTO_OPEN=true node dashboard/server.mjs
```

2. headless/SSH í™˜ê²½ì—ì„œëŠ” ë¸Œë¼ìš°ì € ì—´ê¸°ê°€ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤. ì„œë²„ ë¡œê·¸ì—ì„œ URLì„ í™•ì¸í•˜ê³  ìˆ˜ë™ìœ¼ë¡œ ì ‘ì†í•©ë‹ˆë‹¤:

```bash
# ì„œë²„ ë¡œê·¸ì—ì„œ URL í™•ì¸
# [dashboard] HTTP ì„œë²„ ì‹œì‘: http://localhost:3333

# ìˆ˜ë™ ì ‘ì†
open http://localhost:3333        # macOS
xdg-open http://localhost:3333    # Linux
```

3. ì„œë²„ ë¡œê·¸ì—ì„œ ì˜¤ë¥˜ í™•ì¸:

```bash
node dashboard/server.mjs 2>&1 | grep "ë¸Œë¼ìš°ì €"
# [dashboard] ë¸Œë¼ìš°ì € ì—´ê¸° ì„±ê³µ: http://localhost:3333
# ë˜ëŠ”
# [dashboard] ë¸Œë¼ìš°ì € ì—´ê¸° ì‹¤íŒ¨ (darwin): ...
```

---

### Node.js ë²„ì „ ë¬¸ì œ

**ì¦ìƒ:** `SyntaxError: Cannot use import statement` ë˜ëŠ” `fs.watch recursive option not supported` ì˜¤ë¥˜.

**ì›ì¸ ë° í•´ê²°:**

| ì˜¤ë¥˜ | ì›ì¸ | í•´ê²° |
|------|------|------|
| `import` êµ¬ë¬¸ ì˜¤ë¥˜ | Node.js 12 ì´í•˜ | Node.js 18+ ì„¤ì¹˜ |
| `fs.watch recursive` ì˜¤ë¥˜ | Node.js 18 ë¯¸ë§Œ | Node.js 18+ ì„¤ì¹˜ |
| `URL` ê°ì²´ ì˜¤ë¥˜ | Node.js 10 ì´í•˜ | Node.js 18+ ì„¤ì¹˜ |

```bash
# Node.js ë²„ì „ ì—…ê·¸ë ˆì´ë“œ (nvm ì‚¬ìš©)
nvm install 18
nvm use 18

# ë˜ëŠ” ê³µì‹ ì‚¬ì´íŠ¸ì—ì„œ ë‹¤ìš´ë¡œë“œ
# https://nodejs.org/
```

---

## 7. ê°œë°œì ì°¸ê³ 

### ì´ë²¤íŠ¸ íƒ€ì… ëª©ë¡ (POST /api/events)

`POST /api/events`ë¡œ ì „ì†¡í•  ìˆ˜ ìˆëŠ” ì´ë²¤íŠ¸ íƒ€ì…ì…ë‹ˆë‹¤.

| íƒ€ì… | í•„ìˆ˜ í•„ë“œ | ì„ íƒ í•„ë“œ | ì„¤ëª… |
|------|----------|----------|------|
| `agent_start` | `agent` | `task`, `content` | ì—ì´ì „íŠ¸ ì‘ì—… ì‹œì‘ (status: working) |
| `agent_done` | `agent` | `content`, `result` | ì—ì´ì „íŠ¸ ì‘ì—… ì™„ë£Œ (status: idle) |
| `delegation` | `from`, `to` | `task`, `content` | ì—ì´ì „íŠ¸ ê°„ ìœ„ì„ ë°œìƒ |
| `message` | `agent`, `content` | - | ì—ì´ì „íŠ¸ ë©”ì‹œì§€ (ì±„íŒ… ë·°ì— í‘œì‹œ) |
| `user_prompt` | `content` | `prompt` | ì‚¬ìš©ì ì…ë ¥ |
| `stop` | - | `content` | ë©”ì¸ ì‘ë‹µ ì™„ë£Œ (shinnosuke idle) |
| `session_start` | - | `content` | ì„¸ì…˜ ì‹œì‘ (ì „ì²´ ìƒíƒœ ì´ˆê¸°í™”) |
| `session_end` | - | `content` | ì„¸ì…˜ ì¢…ë£Œ |
| `debate_start` | - | `topic`, `panelists` | Debate ì‹œì‘ |
| `debate_opinion` | `agent`, `opinion` | `round` | Debate ì˜ê²¬ ì¶”ê°€ |
| `debate_conclusion` | - | `conclusion`, `content` | Debate ê²°ë¡  |
| `tool_use` | - | `agent`, `tool`, `content` | ë„êµ¬ ì‚¬ìš© ê¸°ë¡ |
| `workflow_update` | `workflow` | - | ì›Œí¬í”Œë¡œìš° ìƒíƒœ ì§ì ‘ ë³€ê²½ |

**ì˜ˆì‹œ:**

```bash
# ì—ì´ì „íŠ¸ ì‘ì—… ì‹œì‘
curl -X POST http://localhost:3333/api/events \
  -H "Content-Type: application/json" \
  -d '{"type":"agent_start","agent":"bo","task":"ì½”ë“œ êµ¬í˜„ ì¤‘"}'

# ìœ„ì„ ì´ë²¤íŠ¸
curl -X POST http://localhost:3333/api/events \
  -H "Content-Type: application/json" \
  -d '{"type":"delegation","from":"shinnosuke","to":"nene","task":"ìš”êµ¬ì‚¬í•­ ë¶„ì„"}'

# Debate ì‹œì‘
curl -X POST http://localhost:3333/api/events \
  -H "Content-Type: application/json" \
  -d '{"type":"debate_start","topic":"REST vs GraphQL","panelists":["hiroshi","bunta"]}'
```

---

### SSE ì´ë²¤íŠ¸ íƒ€ì… ëª©ë¡ (GET /api/events/stream)

ì„œë²„ì—ì„œ ë¸Œë¼ìš°ì €ë¡œ ë¸Œë¡œë“œìºìŠ¤íŠ¸ë˜ëŠ” SSE ì´ë²¤íŠ¸ íƒ€ì…ì…ë‹ˆë‹¤.

| SSE ì´ë²¤íŠ¸ íƒ€ì… | íŠ¸ë¦¬ê±° ì¡°ê±´ | data êµ¬ì¡° |
|----------------|------------|----------|
| `connected` | SSE ì—°ê²° ì‹œ | `{message, clientId, timestamp, workflow}` |
| `agent_status` | ì—ì´ì „íŠ¸ ìƒíƒœ ë³€ê²½ | `{agent, status, active, timestamp, [task], [lastMessage]}` |
| `delegation` | ìœ„ì„ ì´ë²¤íŠ¸ ë°œìƒ | `{from, to, task, delegationChain, timestamp}` |
| `activity` | ì¼ë°˜ ì´ë²¤íŠ¸ ë°œìƒ | ì´ë²¤íŠ¸ ì›ë³¸ ê°ì²´ |
| `chat_message` | message ì´ë²¤íŠ¸ ìˆ˜ì‹  | `{agent, content, parsed, timestamp}` |
| `debate` | Debate ê´€ë ¨ ì´ë²¤íŠ¸ | `{subtype: 'start'|'opinion'|'conclusion', ...}` |
| `workflow_status` | ì›Œí¬í”Œë¡œìš° ìƒíƒœ ë³€ê²½ | `{workflow, progress, timestamp}` |

**ë¸Œë¼ìš°ì €ì—ì„œ ìˆ˜ì‹  ì˜ˆì‹œ:**

```javascript
const source = new EventSource('http://localhost:3333/api/events/stream');

// ì—ì´ì „íŠ¸ ìƒíƒœ ë³€ê²½ ê°ì§€
source.addEventListener('agent_status', (e) => {
  const data = JSON.parse(e.data);
  console.log(`${data.agent}: ${data.status}`);
  // ì˜ˆ: "bo: working"
});

// ìœ„ì„ ì´ë²¤íŠ¸ ê°ì§€
source.addEventListener('delegation', (e) => {
  const data = JSON.parse(e.data);
  console.log(`${data.from} -> ${data.to}: ${data.task}`);
});

// Debate ì´ë²¤íŠ¸ ê°ì§€
source.addEventListener('debate', (e) => {
  const data = JSON.parse(e.data);
  if (data.subtype === 'conclusion') {
    console.log(`ê²°ë¡ : ${data.conclusion}`);
  }
});

// ì—°ê²° ëŠê¹€ ì²˜ë¦¬ (ìë™ ì¬ì—°ê²°)
source.onerror = (e) => {
  console.log('SSE ì—°ê²° ëŠê¹€, ì¬ì—°ê²° ì¤‘...');
};
```

---

### ì»¤ìŠ¤í…€ ì´ë²¤íŠ¸ ë³´ë‚´ê¸°

ëŒ€ì‹œë³´ë“œì— ì»¤ìŠ¤í…€ ì´ë²¤íŠ¸ë¥¼ ë³´ë‚´ëŠ” ë°©ë²•ì…ë‹ˆë‹¤.

#### curlë¡œ ì§ì ‘ ì „ì†¡

```bash
# ì»¤ìŠ¤í…€ ì—ì´ì „íŠ¸ í™œë™ ì•Œë¦¼
curl -X POST http://localhost:3333/api/events \
  -H "Content-Type: application/json" \
  -d '{
    "type": "message",
    "agent": "shinnosuke",
    "content": "ğŸ“š [Masumi] ë¬¸ì„œ ì‘ì„± ì™„ë£Œ"
  }'
```

#### MCP ë„êµ¬ë¡œ ì „ì†¡ (Claude Code ë‚´ì—ì„œ)

Claude Code ì„¸ì…˜ ë‚´ì—ì„œ `send_agent_event` MCP ë„êµ¬ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤:

```
send_agent_event ë„êµ¬ í˜¸ì¶œ:
  type: delegation
  from: shinnosuke
  to: bo
  task: êµ¬í˜„ ì‹œì‘
```

#### send-event.sh ìŠ¤í¬ë¦½íŠ¸ ì¬í™œìš©

```bash
# í™˜ê²½ë³€ìˆ˜ë¡œ ì´ë²¤íŠ¸ íƒ€ì… ì§€ì •, stdinìœ¼ë¡œ Hook ë°ì´í„° ì „ì†¡
echo '{"agent_type":"team-shinchan:aichan"}' | \
  HOOK_EVENT=SubagentStart \
  DASHBOARD_URL=http://localhost:3333 \
  bash hooks/send-event.sh
```

---

### ì—ì´ì „íŠ¸ ë©”ì‹œì§€ íŒŒì‹± íŒ¨í„´

ì„œë²„ëŠ” ì—ì´ì „íŠ¸ ë©”ì‹œì§€ì—ì„œ ë‘ ê°€ì§€ íŒ¨í„´ì„ ìë™ìœ¼ë¡œ ê°ì§€í•©ë‹ˆë‹¤:

**1. ìœ„ì„ íŒ¨í„´** (ìë™ìœ¼ë¡œ delegation ì´ë²¤íŠ¸ ìƒì„±):

```
{emoji} [{From}] -> {emoji} [{To}] "{message}"

ì˜ˆ: ğŸ‘¦ [Shinnosuke] -> ğŸ˜ª [Bo] "ì½”ë“œ êµ¬í˜„ì„ ì‹œì‘í•´ì£¼ì„¸ìš”"
```

**2. ì—ì´ì „íŠ¸ ë©”ì‹œì§€ íŒ¨í„´** (ì±„íŒ… ë·°ì— í‘œì‹œ):

```
{emoji} [{Agent}] {message}

ì˜ˆ: ğŸ˜ª [Bo] êµ¬í˜„ì„ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤.
```

ì´ íŒ¨í„´ì´ ê°ì§€ë˜ë©´ `chat_message` SSE ì´ë²¤íŠ¸ì— `parsed` í•„ë“œê°€ í¬í•¨ë©ë‹ˆë‹¤:

```json
{
  "type": "delegation_message",
  "from": "shinnosuke",
  "to": "bo",
  "content": "ì½”ë“œ êµ¬í˜„ì„ ì‹œì‘í•´ì£¼ì„¸ìš”"
}
```

ë˜ëŠ”:

```json
{
  "type": "agent_message",
  "agent": "bo",
  "content": "êµ¬í˜„ì„ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤."
}
```

---

*ì´ ë¬¸ì„œëŠ” Team-Shinchan ëŒ€ì‹œë³´ë“œ v1.0.0 ê¸°ì¤€ìœ¼ë¡œ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.*
